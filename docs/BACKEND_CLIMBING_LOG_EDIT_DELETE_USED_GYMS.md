# Бэкенд: редактирование, удаление и подсказки залов (Climbing Log)

Для полноценной работы редактирования, удаления тренировок и подсказок «ваши залы» бэкенду нужно реализовать следующее.

---

## 1. История — добавить `id` и `gym_id` в ответ

**Эндпоинт:** `GET /api/climbing-logs/history`

В каждом объекте сессии в ответе должны быть поля:
- `id` (int) — идентификатор сессии (обязательно для edit/delete)
- `gym_id` (int, опционально) — ID зала (для подсказок и предзаполнения при редактировании)

**Пример ответа:**
```json
[
  {
    "id": 42,
    "date": "2025-02-11",
    "gym_id": 7,
    "gym_name": "RedPoint (Москва)",
    "routes": [
      { "grade": "6A", "count": 2 },
      { "grade": "6B+", "count": 1 }
    ]
  }
]
```

Без `id` кнопки «Редактировать» и «Удалить» в приложении останутся неактивными. Без `gym_id` подсказки «ваши залы» будут строиться только из ответа `used-gyms`.

---

## 2. Редактирование сессии

**Метод:** `PUT` (или `PATCH`)  
**URL:** `PUT /api/climbing-logs/{id}`  
**Заголовки:** `Authorization: Bearer <token>`, `Content-Type: application/json`

**Тело (как у POST):**
```json
{
  "routes": [
    { "grade": "6A", "count": 2 },
    { "grade": "6B+", "count": 3 }
  ],
  "date": "2025-02-11",
  "gym_id": 7
}
```

**Ответ:**  
- `200` — успешно  
- `401` — не авторизован  
- `403` — нет прав на эту сессию  
- `404` — сессия не найдена  
- `422` — ошибка валидации  

---

## 3. Удаление сессии

**Метод:** `DELETE`  
**URL:** `DELETE /api/climbing-logs/{id}`  
**Заголовки:** `Authorization: Bearer <token>`

**Ответ:**
- `200` — удалено  
- `401` — не авторизован  
- `403` — нет прав  
- `404` — не найдена  

---

## 4. Список залов, на которых пользователь тренировался

**Метод:** `GET`  
**URL:** `GET /api/climbing-logs/used-gyms`  
**Заголовки:** `Authorization: Bearer <token>`

**Ответ (200):**
```json
[
  { "id": 7, "name": "RedPoint", "city": "Москва", "last_used": "2025-02-11" },
  { "id": 12, "name": "Скала Сити", "city": "Москва", "last_used": "2025-02-08" }
]
```

| Поле      | Тип    | Обязательное | Описание                          |
|-----------|--------|--------------|-----------------------------------|
| id        | int    | да           | ID зала                           |
| name      | string | да           | Название                          |
| city      | string | нет          | Город                             |
| last_used | string | нет          | Дата последней тренировки (YYYY-MM-DD) |

Список должен быть уникальным по `id` зала, упорядочен по последнему использованию (сначала недавние).

**Примечание:** если эндпоинт не реализован или возвращает пустой список, приложение берёт залы из истории (по `gym_id`), если он есть.

---

## Сводка эндпоинтов

| Метод | URL                           | Описание                          |
|-------|-------------------------------|-----------------------------------|
| PUT   | /api/climbing-logs/{id}        | Редактировать сессию              |
| DELETE| /api/climbing-logs/{id}        | Удалить сессию                    |
| GET   | /api/climbing-logs/used-gyms   | Залы, на которых уже тренировались |

Дополнительно: в ответе `GET /api/climbing-logs/history` добавить поля `id` и `gym_id` в каждую сессию.
